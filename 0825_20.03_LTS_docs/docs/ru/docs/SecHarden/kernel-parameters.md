# Параметры ядра

- [Параметры ядра](#kernel-parameters)
  - [Усиление мер безопасности в отношении параметров ядра](#hardening-the-security-of-kernel-parameters)

## Усиление мер безопасности в отношении параметров ядра

### Описание

Параметры ядра определяют статус конфигурации сети и привилегии по работе с приложениями. Ядро предоставляет функцию управления системой, которую пользователи могут конфигурировать и детально настраивать. Эта функция поможет повысить безопасность операционной системы. Например, для повышения безопасности системы можно детально настроить или сконфигурировать сетевые параметры.

### Реализация

1. Внесите параметры повышения безопасности, приведенные в [Табл. 1](#en-us_topic_0152100187_t69b5423c26644b26abe94d88d38878eb), в файл **/etc/sysctl.conf**.
   
   > ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
Внесите следующие параметры повышения безопасности:
   > 
   > ```
   > net.ipv4.icmp_echo_ignore_broadcasts = 1  
   > net.ipv4.conf.all.rp_filter = 1  
   > net.ipv4.conf.default.rp_filter = 1  
   > ```
   
   **Табл. 1** Политика повышения безопасности параметров ядра
   
   
   
   | **Параметр**                               | **Описание**                                                 | **Рекомендация** | **Сконфигурировано в соответствии с рекомендацией** |
   | ------------------------------------------ | ------------------------------------------------------------ | ---------------- | --------------------------------------------------- |
   | net.ipv4.icmp_echo_ignore_broadcasts       | Параметр определяет, принимать или не принимать широковещательные пакеты ICMP. Согласно политике усиления безопасности, пакеты не принимаются. | 1                | Да                                                  |
   | net.ipv4.conf.all.rp_filter                | Параметр определяет, привязан или нет фактический IP-адрес источника, используемый пакетом данных, к таблице маршрутизации, и принимает или нет пакет данных ответы через интерфейсы. Согласно политике усиления безопасности, данный параметр включен. | 1                | Да                                                  |
   | net.ipv4.conf.default.rp_filter            | Параметр определяет, привязан или нет фактический IP-адрес источника, используемый пакетом данных, к таблице маршрутизации, и принимает или нет пакет данных ответы через интерфейсы. Согласно политике усиления безопасности, данный параметр включен. | 1                | Да                                                  |
   | net.ipv4.ip_forward                        | Функция переадресации IP предотвращает передачу пакетов в сеть через неразрешенные IP-адреса. Согласно политике усиления безопасности, данный параметр отключен. | 0                | Да                                                  |
   | net.ipv4.conf.all.accept_source_route      | **accept_source_route** означает, что отправитель пакета может указать путь для отправки пакета и путь для получения ответа. Согласно политике усиления безопасности, данный параметр отключен. | 0                | Да                                                  |
   | net.ipv4.conf.default.accept_source_route  | **accept_source_route** означает, что отправитель пакета может указать путь для отправки пакета и путь для получения ответа. Согласно политике усиления безопасности, данный параметр отключен. | 0                | Да                                                  |
   | net.ipv4.conf.all.accept_redirects         | Параметр определяет, будет или нет посылаться перенаправленный ICMP-пакет. Согласно политике усиления безопасности, такой пакет не посылается. | 0                | Да                                                  |
   | net.ipv4.conf.default.accept_redirects     | Параметр определяет, будет или нет посылаться перенаправленный ICMP-пакет. Согласно политике усиления безопасности, такой пакет не посылается. | 0                | Да                                                  |
   | net.ipv6.conf.all.accept_redirects         | Параметр определяет, будет или нет посылаться перенаправленный ICMP-пакет. Согласно политике усиления безопасности, такой пакет не посылается. | 0                | Да                                                  |
   | net.ipv6.conf.default.accept_redirects     | Параметр определяет, будет или нет посылаться перенаправленный ICMP-пакет. Согласно политике усиления безопасности, такой пакет не посылается. | 0                | Да                                                  |
   | net.ipv4.conf.all.send_redirects           | Параметр определяет, будет или нет перенаправленный ICMP-пакет посылаться на другой сервер. Этот параметр включается только тогда, когда хост функционирует как маршрут. Согласно политике усиления безопасности, данный параметр отключен. | 0                | Да                                                  |
   | net.ipv4.conf.default.send_redirects       | Параметр определяет, будет или нет перенаправленный ICMP-пакет посылаться на другой сервер. Этот параметр включается только тогда, когда хост функционирует как маршрут. Согласно политике усиления безопасности, данный параметр отключен. | 0                | Да                                                  |
   | net.ipv4.icmp_ignore_bogus_error_responses | Поддельные ICMP-пакеты не записываются в журналы, что экономит дисковое пространство. Согласно политике усиления безопасности, данный параметр включен. | 1                | Да                                                  |
   | net.ipv4.tcp_syncookies                    | Атака SYN представляет собой DoS-атаку, которая принудительно перезагружает систему, занимая системные ресурсы. Согласно политике усиления безопасности, данный параметр включен. | 1                | Да                                                  |
   | kernel.dmesg_restrict                      | Повышает безопасность передачи сообщений dmesg. Просмотр данных сообщений разрешен только администратору. | 1                | Да                                                  |
   | kernel.sched_autogroup_enabled             | Параметр определяет автоматическое объединение в группы и планирование потоков ядром. После включения этого параметра группы планирования конкурируют за временные отрезки, а потоки в группе планирования конкурируют за временные отрезки, выделенные группе планирования. Согласно политике усиления безопасности, данный параметр отключен. | 0                | Нет                                                 |
   | kernel.sysrq                               | Отключение функции «волшебного ключа» (magic key). ПРИМЕЧАНИЕ: Рекомендуется отключить эту функцию, чтобы команды не передавались напрямую ядру. | 0                | Да                                                  |
   | net.ipv4.conf.all.secure_redirects         | Параметр определяет, будут или не будут приниматься перенаправленные сообщения ICMP, которые посылаются с любых серверов или шлюзов, перечисленных в списке шлюзов по умолчанию. Согласно политике усиления безопасности, перенаправленные ICMP-сообщения принимаются от любых серверов. | 0                | Да                                                  |
   | net.ipv4.conf.default.secure_redirects     | Параметр определяет, будут или не будут приниматься перенаправленные сообщения ICMP, которые посылаются с любых серверов или шлюзов, перечисленных в списке шлюзов по умолчанию. Согласно политике усиления безопасности, перенаправленные ICMP-сообщения принимаются от любых серверов. | 0                | Да                                                  |
   
2. Выполните следующую команду, чтобы загрузить параметры ядра, установленные в файле **sysctl.conf**:
   
   ```
   sysctl -p  /etc/sysctl.conf
   ```

### Другие рекомендации по мерам безопасности

- **net.ipv4.icmp\_echo\_ignore\_all**: при настройке данного параметра игнорируются запросы ICMP.
  
  Для целей безопасности рекомендуется включить этот параметр. Значение по умолчанию — **0**. Установите значение 1, чтобы включить этот параметр.
  
  После включения этого параметра все входящие пакеты запросов ICMP Echo будут игнорироваться, что приведет к ошибке проверки целевого хоста командой ping. Включать или не включать этот параметр — зависит от фактических условий сети.

- **net.ipv4.conf.all.log\_martians/net.ipv4.conf.default.log\_martians**: подделка журналов, маршрутизация от источника и перенаправляемые пакеты.
  
  Для целей безопасности рекомендуется включить этот параметр. Значение по умолчанию — **0**. Установите значение 1, чтобы включить этот параметр.
  
  После включения этого параметра в журнале будут регистрироваться данные, полученные с запрещенных IP-адресов. В связи с тем, что зафиксировано общее разрешенное количество журналов, слишком большое число новых журналов будут перезаписывать файлы старых журналов. Включать или не включать этот параметр — зависит от фактического сценария использования.

- **net.ipv4.tcp\_timestamps**: отключает tcp\_timestamps.
  
  Для целей безопасности рекомендуется отключить tcp\_timestamps. Значение по умолчанию — **1**. Установите значение **0**, чтобы отключить tcp\_timestamps.
  
  Отключение этого параметра отразится на времени ожидания повторной передачи TCP. Включать или не включать этот параметр — зависит от фактического сценария использования.

- **net.ipv4.tcp\_max\_syn\_backlog**: определяет количество очередей, которые находятся в состоянии SYN\_RECV.
  
  Данный параметр определяет количество очередей, которые находятся в состоянии SYN\_RECV. При превышении этого количества новые запросы на соединение TCP не принимаются. В какой-то степени эта мера предотвращает исчерпание системных ресурсов. Сконфигурируйте этот параметр в соответствии с фактическим сценарием использования.