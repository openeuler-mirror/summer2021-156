# Пароли учетных записей

- [Пароли учетных записей](#account-passwords)
  - [Маскировка системных учетных записей](#shielding-system-accounts)
  - [Ограничение прав на команду **su**](#restricting-permissions-on-the-su-command)
  - [Установка сложности пароля](#setting-password-complexity)
  - [Установка периода действия пароля](#setting-the-password-validity-period)
  - [Установка алгоритмов шифрования пароля](#setting-password-encryption-algorithms)
  - [Блокировка учетной записи после трех неудачных попыток входа](#locking-an-account-after-three-login-failures)
  - [Повышение уровня безопасности при работе с командой **su**](#hardening-the-su-command)

## Маскировка системных учетных записей

### Описание

Системными учетными записями называются те учетные записи, которые не применяются пользователями. Системные учетные записи не используются для входа в систему или выполнения других операций. Поэтому системные учетные записи необходимо защитить.

### Реализация

Измените оболочку системной учетной записи на **/sbin/nologin**.

```
usermod -L -s /sbin/nologin $systemaccount
```

> ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
_$systemaccount_ -- это системная учетная запись.

## Ограничение прав на команду **su**

### Описание

Команда **su** используется для переключения между учетными записями пользователей. Чтобы повысить безопасность системы, команду **su** могут выполнять только пользователь **root** и пользователи группы **wheel**.

### Реализация

Измените файл /**etc/pam.d/su** следующим образом:

```
auth         required      pam_wheel.so use_uid
```

  

**Табл. 1** Конфигурационный параметр в файле pam\_wheel.so

| **Параметр** | **Описание**                                       |
| ------------ | -------------------------------------------------- |
| use_uid      | Идентификатор пользователя текущей учетной записи. |

## Установка сложности пароля

### Описание

Требования к сложности пароля устанавливаются путем изменения соответствующего конфигурационного файла. Рекомендуется устанавливать сложность пароля в соответствии с требованиями площадки.

### Реализация

Сложность пароля реализуется модулями **pam\_pwquality.so** и **pam\_pwhistory.so** в файлах **/etc/pam.d/password-auth** и **/etc/pam.d/system-auth**. Чтобы изменить требования к сложности пароля, можно внести изменения в конфигурационные параметры двух модулей.

### Пример

В этом разделе приведен пример установки сложности пароля.

**Требования к сложности пароля**

1. Пароль должен содержать не менее восьми символов.

2. Пароль должен содержать не менее трех типов следующих символов:
   
   - Минимум одна строчная буква
   
   - Минимум одна прописная буква
   
   - Минимум одна цифра
   
   - Минимум один пробел или один специальный символ: \` ~ ! @ # $ % \^ \& \* ( ) - \_ = + \\ \| \[ { } ] ; : ' " , \< . \> / ?

3. Пароль не должен совпадать с написанием имени учетной записи, а также с написанием имени учетной записи в обратном порядке.

4. Исключается использование последних пяти установленных паролей.

**Реализация**

Добавьте следующее содержимое в файлы **/etc/pam.d/password-auth** и **/etc/pam.d/system-auth**:

```
password    requisite     pam_pwquality.so minlen=8 minclass=3 enforce_for_root try_first_pass local_users_only retry=3 dcredit=0 ucredit=0 lcredit=0 ocredit=0 
password    required      pam_pwhistory.so use_authtok remember=5 enforce_for_root
```

  

**Описание конфигурационного параметра**

Более подробную информацию о конфигурационных параметрах **pam\_pwquality.so** и **pam\_pwhistory.so** можно найти в [Табл. 1](#table201221044172117) и [Табл. 2](#table1212544452120) соответственно.

**Табл. 1** Конфигурационные параметры в файле pam\_pwquality.so

| **Параметр**     | **Описание**                                                 |
| ---------------- | ------------------------------------------------------------ |
| minlen=8         | Пароль должен содержать не менее восьми символов.            |
| minclass=3       | Пароль должен содержать как минимум три типа символов: прописные буквы, строчные буквы, цифры и специальные символы. |
| ucredit=0        | Пароль может содержать любое количество прописных букв.      |
| lcredit=0        | Пароль может содержать любое количество строчных букв.       |
| dcredit=0        | Пароль может содержать любое количество цифр.                |
| ocredit=0        | Пароль может содержать любое количество специальных символов. |
| retry=3          | За один раз допускается максимум три изменения пароля.       |
| enforce_for_root | Эта конфигурация эффективна также для пользователя **root**. |

**Табл. 2** Конфигурационные параметры в файле pam\_pwhistory.so

| **Параметр**     | **Описание**                                                 |
| ---------------- | ------------------------------------------------------------ |
| remember=5       | Пароль должен отличаться от последних пяти использованных паролей. |
| enforce_for_root | Эта конфигурация эффективна также для пользователя **root**. |

## Установка периода действия пароля

### Описание

Для обеспечения безопасности системы рекомендуется установить период действия пароля и уведомлять пользователей о смене паролей до истечения данного периода.

### Реализация

Период действия пароля устанавливается путем изменения файла **/etc/login.defs**. В [Табл. 1](#en-us_topic_0152100281_t77b5d0753721450c81911c18b74e82eb) приведено описание параметров усиления безопасности. Все параметры усиления безопасности включаются в файл **/etc/login.defs**. Эти параметры можно изменять непосредственно в конфигурационном файле.

**Табл. 1** Конфигурационные параметры в файле login.defs

| **Параметр**  | **Описание**                                                 | **Рекомендация** | **Сконфигурировано в соответствии с рекомендацией** |
| ------------- | ------------------------------------------------------------ | ---------------- | --------------------------------------------------- |
| PASS_MAX_DAYS | Максимальный срок действия пароля.                           | 90               | Нет                                                 |
| PASS_MIN_DAYS | Минимальный интервал между изменениями пароля.               | 0                | Нет                                                 |
| PASS_WARN_AGE | Количество дней, оставшихся до истечения срока действия пароля. | 7                | Нет                                                 |

> ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
Файл **login.defs** используется для установления ограничений на учетные записи пользователей, например для настройки максимального периода действия и максимальной длины пароля. Установленные в этом файле ограничения не действуют в отношении пользователя **root**. Если файл **/etc/shadow** содержит такие же параметры, настройки **/etc/shadow** имеют приоритет над настройками файла **/etc/login.defs**. Пользователь, пытающийся войти после истечения срока действия пароля, информируется об истечении срока действия и необходимости смены пароля. Пользователь, не сменивший пароль, не получает доступ к системе.

## Установка алгоритмов шифрования пароля

### Описание

В целях безопасности системы пароли нельзя хранить в открытом виде, их необходимо зашифровать. Пароли, которые не требуется восстанавливать, необходимо шифровать с помощью алгоритмов необратимого шифрования. Установите алгоритм шифрования пароля SHA-512. В операционной системе openEuler этот алгоритм установлен по умолчанию. Вышеприведенные настройки не допустят раскрытия пароля и обеспечат его безопасность.

### Реализация

Чтобы установить алгоритм шифрования пароля, добавьте следующие настройки в файлы **/etc/pam.d/password-auth** и **/etc/pam.d/system-auth**:

```
password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok
```

  

**Табл. 1** Конфигурационные параметры в файле pam\_unix.so

| **Параметр** | **Описание**                                          |
| ------------ | ----------------------------------------------------- |
| sha512       | Алгоритм SHA-512 используется для шифрования паролей. |

## Блокировка учетной записи после трех неудачных попыток входа

### Описание

Для обеспечения безопасности системы пользователя рекомендуется установить максимальное количество раз ввода неверного пароля (рекомендуется три попытки) и время автоматической разблокировки (рекомендуется 300 секунд) заблокированной учетной записи.

В период блокирования учетной записи любая попытка входа будет неуспешной, но при этом, подсчет таких неуспешных попыток не производится. Записи неуспешных попыток входа пользователя удаляются после разблокировки. Вышеприведенные настройки защищают пароли от принудительного взлома и улучшают безопасность системы.

> ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
По умолчанию максимальное количество попыток ввода неверного пароля в openEuler составляет 3. Автоматически система разблокируется через 60 секунд.

### Реализация

Сложность пароля устанавливается путем изменения файлов **/etc/pam.d/password-auth** и **/etc/pam.d/system-auth**. Максимальное количество попыток ввода неверного пароля установлено в значение **3**, а время разблокировки системы установлено в значение **300** секунд. Метод настройки:

```
auth        required      pam_faillock.so preauth audit deny=3 even_deny_root unlock_time=300
auth        [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=300
auth        sufficient    pam_faillock.so authsucc audit deny=3 even_deny_root unlock_time=300
```

**Табл. 1** Конфигурационные параметры в файле pam\_faillock.so

| **Параметр**    | Описание                                                     |
| --------------- | ------------------------------------------------------------ |
| authfail        | Сбор событий сбоя входа в учетную запись.                    |
| deny=3          | Учетная запись пользователя блокируется после трех попыток входа. |
| unlock_time=300 | Заблокированная учетная запись обычного пользователя автоматически разблокируется через 300 секунд. |
| even_deny_root  | Эта конфигурация эффективна также для пользователя **root**. |

## Повышение уровня безопасности при работе с командой **su**

### Описание

Чтобы повысить безопасность системы и предотвратить передачу переменных среды текущего пользователя в другие среды во время переключения на другого пользователя командой **su**, данный параметр настроен в ОС openEuler по умолчанию. Переменная **PATH** инициализируется всегда, когда команда **su** используется для переключения пользователей.

### Реализация

Внесите изменения в файл **/etc/login.defs**. Метод настройки:

```
ALWAYS_SET_PATH=yes
```