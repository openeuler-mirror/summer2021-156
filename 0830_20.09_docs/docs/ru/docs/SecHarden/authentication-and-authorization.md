# Аутентификация и авторизация

- [Аутентификация и авторизация](#authentication-and-authorization)
  - [Настройка предупреждения об удаленном доступе к сети](#setting-a-warning-for-remote-network-access)
  - [Предотвращение неавторизованного перезапуска системы, выполняемого удерживанием нажатыми клавиш Ctrl, Alt и Delete](#forestalling-unauthorized-system-restart-by-holding-down-ctrl-alt-and-delete)
  - [Установка интервала автоматического выхода из оболочки](#setting-an-automatic-exit-interval-for-shell)
  - [Установка параметра umask в значение по умолчанию 0077 для пользователей](#setting-the-default-umask-value-for-users-to-0077)
  - [Установка пароля шифрования GRUB2](#setting-the-grub2-encryption-password)
  - [Настройка безопасного режима одного пользователя](#setting-the-secure-single-user-mode)
  - [Отключение интерактивного запуска](#disabling-interactive-startup)

## Настройка предупреждения об удаленном доступе к сети

### Описание

Предупреждение об удаленном доступе к сети настраивается и появляется для тех пользователей, которые пытаются удаленно войти в систему. Предупреждение уведомляет о штрафе за неавторизованный доступ и используется как средство угрозы потенциальным нарушителям. При появлении данного предупреждения архитектура системы и остальная информация о системе скрываются, чтобы защитить систему от атаки.

### Реализация

Эта настройка выполняется путем внесения изменений в файл **/etc/issue.net**. Замените исходное содержимое в файле **/etc/issue.ne**t следующей информацией (которая была установлена по умолчанию в ОС openEuler):

```
Authorized users only. All activities may be monitored and reported. 
```

## Предотвращение неавторизованного перезапуска системы, выполняемого удерживанием нажатыми клавиш Ctrl, Alt и Delete

### Описание

По умолчанию перезапустить ОС можно, удерживая нажатыми клавиши **Ctrl, Alt **и **Delete**. Отключение этой функции предотвратит потерю данных, вызванную ошибочным нажатием клавиш.

### Реализация

Чтобы отключить функцию перезапуска системы, выполняемого нажатием и удерживанием клавиш **Ctrl, Alt** и **Delete**, выполните следующие шаги:

1. Удалите два файла **ctrl-alt-del.target** следующей командой:
   
   ```
   rm -f /etc/systemd/system/ctrl-alt-del.target
   rm -f /usr/lib/systemd/system/ctrl-alt-del.target
   ```

2. Измените **#CtrlAltDelBurstAction=reboot-force** на **CtrlAltDelBurstAction=none** в файле **/etc/systemd/system.conf**.

3. Следующей командой перезапустите службу systemd, чтобы изменение вступило в силу:
   
   ```
   systemctl daemon-reexec
   ```

## Установка интервала автоматического выхода из оболочки

### Описание

Автономно работающая оболочка подвержена прослушиваниям и атакам. Поэтому необходимо сконфигурировать механизм, который обеспечит автоматическое завершение сеанса и выход из оболочки при отсутствии действий пользователя в течение определенного времени.

### Реализация

В конце файла **/etc/profile** выполните следующие настройки в поле **TMOUT** (единица: секунда), который определяет интервал автоматического выхода:

```
export TMOUT=300
```

## Установка параметра umask в значение по умолчанию 0077 для пользователей

### Описание

Значение **umask** используется для установки разрешений по умолчанию на работу с файлами и каталогами. Меньшее значение **umask** указывает на то, что пользователям группы или другим пользователям установлено некорректное разрешение, что сопряжено с рисками безопасности системы. Поэтому **umask** по умолчанию для всех пользователей должно быть установлено в значение 0077, то есть разрешение на работу с пользовательскими каталогами по умолчанию равно **700**, а разрешение на работу с пользовательскими файлами — **600.** Данное значение служит дополнением к значению разрешения. Подробнее о том, как преобразовать значение **umask** в значение разрешения см. в разделе [Значения umask](#umask-values.md).

> ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
По умолчанию **umask** пользователя openEuler установлено в значение 0077.

### Реализация

1. Добавьте **umask 0077** в файл **/etc/bashrc** и во все файлы в каталоге **/etc/profile.d/**.
   
   ```
   echo "umask 0077" >> $FILE
   ```
   
   > ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
*$FILE* — это имя файла, например echo "umask 0077" >> /etc/bashrc.

2. Установите владельца и группу для файла **/etc/bashrc** и всех файлов в каталоге **/etc/profile.d/** в значение **root**.
   
   ```
   chown root.root $FILE
   ```
   
   > ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
*$FILE* — это имя файла, например **chown root.root /etc/bashrc**.

## Установка пароля шифрования GRUB2

### Описание

GRand Unified Bootloader (GRUB) представляет собой менеджер загрузки различных операционных систем (например, Windows и Linux). GRUB2 — это обновленная версия GRUB.

На экране GRUB2 можно изменить параметры запуска во время запуска системы. Чтобы не допустить случайного изменения параметров, необходимо защитить экран GRUB2 паролем. Таким образом, параметры запуска можно будет изменить только при вводе верного пароля GRUB2.

> ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
Паролем на экран GRUB2 по умолчанию является **openEuler#12**. Рекомендуется изменить данный пароль при первом входе и периодически его менять. В случае утечки сведений о пароле возможна ситуация незаконного изменения конфигурационных параметров запуска, что может привести к сбою запуска системы.

### Реализация

1. Сгенерируйте зашифрованный пароль, выполнив команду **grub2-mkpasswd-pbkdf2**.
   
   > ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
Для шифрования GRUB2 используется алгоритм SHA-512.
   
   ```
   # grub2-mkpasswd-pbkdf2
   Enter password: 
   Reenter password: 
   PBKDF2 hash of your password is 
   grub.pbkdf2.sha512.10000.5A45748D892672FDA02DD3B6F7AE390AC6E6D532A600D4AC477D25C7D087644697D8A0894DFED9D86DC2A27F4E01D925C46417A225FC099C12DBD3D7D49A7425.2BD2F5BF4907DCC389CC5D165DB85CC3E2C94C8F9A30B01DACAA9CD552B731BA1DD3B7CC2C765704D55B8CD962D2AEF19A753CBE9B8464E2B1EB39A3BB4EAB08
   ```
   
   > ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:  
Введите одинаковый пароль в строках **Enter password** и **Reenter password**.  
После завершения шифрования пароля **openEuler#12** командой **grub2-mkpasswd-pbkdf2** командный вывод будет выглядеть подобным образом: **grub.pbkdf2.sha512.10000.5A45748D892672FDA02DD3B6F7AE390AC6E6D532A600D4AC477D25C7D087644697D8A0894DFED9D86DC2A27F4E01D925C46417A225FC099C12DBD3D7D49A7425.2BD2F5BF4907DCC389CC5D165DB85CC3E2C94C8F9A30B01DACAA9CD552B731BA1DD3B7CC2C765704D55B8CD962D2AEF19A753CBE9B8464E2B1EB39A3BB4EAB08**. Зашифрованный текст каждый раз будет отличаться.

2. Откройте **/boot/efi/EFI/openEuler/grub.cfg** в редакторе vi. Добавьте следующие поля в начале файла **/boot/efi/EFI/openEuler/grub.cfg**.
   
   ```
   set superusers="root"
   password_pbkdf2 root grub.pbkdf2.sha512.10000.5A45748D892672FDA02DD3B6F7AE390AC6E6D532A600D4AC477D25C7D087644697D8A0894DFED9D86DC2A27F4E01D925C46417A225FC099C12DBD3D7D49A7425.2BD2F5BF4907DCC389CC5D165DB85CC3E2C94C8F9A30B01DACAA9CD552B731BA1DD3B7CC2C765704D55B8CD962D2AEF19A753CBE9B8464E2B1EB39A3BB4EAB08
   ```
   
   > ![](./public_sys-resources/icon-note.gif) ПРИМЕЧАНИЕ:
   > 
   > - В поле **superusers** указывается имя учетной записи суперпользователя-администратора GRUB2.
   > - Первый параметр после поля **password\_pbkdf2** — это имя учетной записи GRUB2, а второй — зашифрованный пароль учетной записи.

## Настройка безопасного режима одного пользователя

### Описание

Вход в систему как пользователь **root** в режиме одного пользователя при условии, что пароль **root** не установлен, создает высокий риск безопасности.

### Реализация

Эта настройка выполняется путем внесения изменений в файл **/etc/sysconfig/init**. Установите параметр **SINGLE=/sbin/sulogin**.

## Отключение интерактивного запуска

### Описание

Используя интерактивные подсказки, пользователи консоли могут отключить аудит, межсетевой экран или другие службы, что ставит под угрозу безопасность системы. В целях повышения безопасности пользователи могут отключить интерактивный режим запуска. В операционной системе openEuler этот параметр отключен по умолчанию.

### Реализация

Эта настройка выполняется путем внесения изменений в файл **/etc/sysconfig/init**. Установите параметру PROMPT значение **no**.